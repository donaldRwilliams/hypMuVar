---
output: github_document
bibliography: C:\\Users\\willidon\\Box Sync\\r_packages\\hypMuVar\\man\\bib\\bibliography.bib
---
```{r, echo = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>",
  fig.path = "man/figures/README-",
  dev = "png",
  dpi = 500,
  fig.align = "center"
)
```


# hypMuVar: Bayesian Hypothesis  <br/> Testing of Mean-Variance Relations

## Overview
This is a dedicated R package for testing mean-variance relations. Currently the methodology is for Bayesian mixed-effects *location scale* models [MELSM, mel$\cdot$zem; @Hedeker2008], where mean and (within-person) variance relations are tested in the distribution of random effects. This is accomplished with *covariance* selection, in which the random effects correlations are tested with a mixture
of prior distributions. In future releases, this package will allow for testing other mean-variance relations, including linear models (no random effects) and fixed effects in the MELSM.

### Who actually studies mean-variance relations ?
Across the sciences, there is large literature investigating mean-variance 
relations [e.g., @nakagawa2015meta; @xiao2015process; @moreno2003relationship]. 
The typical pattern is that means are positively correlated with
variances (or standard deviations)^[Interestingly, I recently came across a paper investigating the mean-variance relation in guppies [@mitchell2016towards]. Apparently, in that field, the MELSM has been termed the  *doubly hierarchical model* (see here [dhglm](https://rdrr.io/cran/dhglm/)).].
As one example, in ecology the relationship between the mean and variance of species abundance is known as [Taylor's law](https://en.wikipedia.org/wiki/Taylor%27s_law). That Wikipedia page in particular includes interesting references that date back 
to the 1920's (e.g., Jerzy Neyman studied the mean-variance relation in 1926). 
Furthermore, a related line of research has set out to identify processes that violate the "law" [e.g., @Pratte2010; @Schwarz2012].

In my field (psychology), there is also a rich (perhaps the richest!) tradition of studying mean-variance relations. The most prominent example comes from cognitive psychology, where a *lawful*, linear relation between reaction time means and standard deviations was proposed in @wagenmakers2007linear. Accordingly, we demonstrated the utility of our methodology in cognitive inhibition tasks [see @williams2019beneath]. 

### Is hypMuVar necessary ?
**hypMuVar** is not meant to be a general package for mixed-effects modeling (see here [brms](https://github.com/paul-buerkner/brms)). There is certainly a need for **hypMuVar**, however, because the testing strategy is not possible with current software. I anticipate this package will be most useful for researchers specifically interested in testing (possibly confirmatory) hypotheses about the mean-variance relation or the (within-person) variance structure in general (in future releases). This extends inference beyond the customary goal (of testing mean differences) and thus opens the door for answering novel research questions.

## Installation
```{r, eval=F}
# install.packages("devtools")
devtools::install_github("donaldRwilliams/hypMuVar")
```


```{r}
library(hypMuVar)
```


## Random slopes for the location and scale:
```{r,eval=F}
fit <- melsm(fixed_location = rt ~  congruency,
             random_location = ~  congruency | ID,
             fixed_scale = sigma ~  congruency,
             random_scale = ~ congruency | ID,  
             mixture = "SSVS", k = 3,
             adapt = 5000, 
             iter = 10000, 
             data = stroop)
```

```{r,echo=F}
load("C:/Users/willidon/Box Sync/r_packages/rmd_files/fit.Rdata")
```

```{r, eval=T, set-options, echo=-1}
options(width = 250)
summary(fit)
```

### Marginal Bayes Factors
k2 (positive component) vs. the compliment
```{r}
bf <- marginal_bf(fit, H1 = "k2")

bf
```

k2 (positive component) vs. k1(null component)
```{r}
# note testing against the compliment is preferable
bf <- marginal_bf(fit, H1 = "k2", H2 = "k1")

bf
```

### Posterior Model Probabilities
```{r}
prob <- model_prob(fit)

prob
````

#### References
